# yaml-language-server: $schema=https://raw.githubusercontent.com/omni-oss/omni/refs/heads/json-schemas/project-latest.json
name: "@repo/site"

extends:
  - "@workspace/omni/presets/ts-app.omni.yaml"

cache:
  key:
    files:
      append:
        - content/**/*
        - source.config.ts
        - vite.config.ts
        - source.generated.ts

tasks:
  test:
    enabled: false

  test:unit:
    enabled: false

  test:integration:
    enabled: false

  gen:declspec:
    command: bun run gen:declspec

  gen:refdocs:
    cache:
      key:
        files:
          append:
            - ./scripts/generate-references/**/*
            - ./omni-declspec.json

    dependencies:
      - gen:declspec
    command: bun run gen:refdocs
    output:
      files:
        - content/docs/references/**/*

  gen:
    dependencies:
      - gen:refdocs

  build:
    dependencies:
      - gen:refdocs

    output:
      files:
        - .vercel/**/*

  preview:
    dependencies:
      - build
    persistent: true
    command: bun run preview
