# yaml-language-server: $schema=https://raw.githubusercontent.com/omni-oss/omni/refs/heads/json-schemas/project-latest.json
name: rust-cli

extends:
  - ./rust.omni.yaml

tasks:
  build:
    command: cargo build --release --package ${PROJECT_NAME} ${RUST_BUILD_ADDITIONAL_ARGS:-}
    cache:
      key:
        env:
          append: [RUST_BUILD_ADDITIONAL_ARGS]
    dependencies:
      - test
    output:
      files:
        append:
          - "@workspace/target/release/{{ env.PROJECT_NAME }}"
          - "@workspace/target/release/{{ env.PROJECT_NAME }}.exe"

  install:
    cache:
      enabled: false
    command: cargo install --path .
    dependencies:
      - test

meta:
  type: cli
  release:
    github: true
