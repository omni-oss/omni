# yaml-language-server: $schema=https://raw.githubusercontent.com/omni-oss/omni/refs/heads/json-schemas/project-latest.json
name: rust-service

extends:
  - ./rust.omni.yaml

tasks:
  build:
    command: cargo build --release --package ${PROJECT_NAME} ${RUST_BUILD_ADDITIONAL_ARGS:-}
    cache:
      key:
        env:
          append: [RUST_BUILD_ADDITIONAL_ARGS]
    dependencies:
      - test

  dev:
    interactive: true
    persistent: true
    cache:
      enabled: false
    command: watchexec -d 2s -r --exts rs -w src cargo run --package ${PROJECT_NAME} ${ADDITIONAL_ARGS:-}

meta:
  type: service
  release:
    github: true
