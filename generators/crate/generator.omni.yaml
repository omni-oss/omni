# yaml-language-server: $schema=../../.artifacts/generator.json
name: crate
display_name: Rust Crate
description: Generate a new rust crate

prompts:
  - type: confirm
    name: use_tracing
    message: Use tracing
    default: true

  - type: select
    name: crate_type
    message: Crate type
    options:
      - name: Library
        value: lib
      - name: Binary
        value: bin

  - type: text
    name: crate_name
    message: Crate name
    validate:
      - condition: "{{ value | length > 0 }}"
        error_message: Crate name must not be empty
      - condition: "{{ value is matching('^[a-zA-Z_]{1}[a-zA-Z0-9_-]*$') }}"
        error_message: Crate name must only contain alphanumeric characters, underscores, and hyphens, and must start with a letter

actions:
  - type: add
    template_file: files/Cargo.toml.tpl
    base_path: files

  - type: add
    template_file: files/src/lib.rs.tpl
    base_path: files

  - if: "{{ prompts.crate_type == 'bin' }}"
    type: add
    template_file: files/src/main.rs.tpl
    base_path: files

  - type: add
    template_file: files/project.omni.yaml.tpl
    base_path: files
